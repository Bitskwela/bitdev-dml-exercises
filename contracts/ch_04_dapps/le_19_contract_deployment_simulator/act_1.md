# Activity 1: Build DeploySimulator Component ‚è±Ô∏è 10 mins

Create `DeploySimulator.js` where users input a greeting string, click **Deploy**, and see the new contract address appear. Use a pre-compiled `HelloWorld.json` artifact containing ABI & bytecode.

## üìã Contract Baseline

**Solidity Contract (`HelloWorld.sol`)**

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.7;

contract HelloWorld {
    string public greeting;
    event Deployed(address indexed deployer, address indexed addr, string greeting);

    constructor(string memory _greeting) {
        greeting = _greeting;
        emit Deployed(msg.sender, address(this), _greeting);
    }

    function setGreeting(string memory _greet) external {
        greeting = _greet;
    }
}
```

## üöÄ Starter Code

**`DeploySimulator.js`**

```js
import React, { useState } from "react";
import { ethers } from "ethers";
// Precompiled artifact generated by Hardhat or Remix
import HelloWorldArtifact from "../artifacts/HelloWorld.json";

export default function DeploySimulator({ onDeployed }) {
  const [greet, setGreet] = useState("");
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState("");

  async function deploy() {
    try {
      setError("");
      setLoading(true);
      // TODO: request accounts
      // TODO: provider = new ethers.providers.Web3Provider(window.ethereum)
      // TODO: signer = provider.getSigner()
      // TODO: factory = new ethers.ContractFactory(artifact.abi, artifact.bytecode, signer)
      // TODO: contract = await factory.deploy(greet)
      // TODO: await contract.deployed()
      // TODO: onDeployed(contract.address)
    } catch (err) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  }

  return (
    <div>
      <h4>Deploy HelloWorld Contract</h4>
      <input
        placeholder="Greeting message"
        value={greet}
        onChange={(e) => setGreet(e.target.value)}
      />
      <button onClick={deploy} disabled={loading || !greet}>
        {loading ? "Deploying‚Ä¶" : "Deploy"}
      </button>
      {error && <p style={{ color: "red" }}>{error}</p>}
    </div>
  );
}
```

## ‚úÖ To Do List

- [ ] Connect MetaMask via `eth_requestAccounts`.
- [ ] Instantiate `Web3Provider` and `Signer`.
- [ ] Build `ContractFactory` with imported ABI & bytecode.
- [ ] Call `factory.deploy(greet)` and `await contract.deployed()`.
- [ ] Invoke `onDeployed(address)` callback.

## üéØ Full Solution

```js
// DeploySimulator.js
import React, { useState } from "react";
import { ethers } from "ethers";
import HelloWorldArtifact from "../artifacts/HelloWorld.json";

export default function DeploySimulator({ onDeployed }) {
  const [greet, setGreet] = useState("");
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState("");

  async function deploy() {
    setError("");
    setLoading(true);
    try {
      await window.ethereum.request({ method: "eth_requestAccounts" });
      const provider = new ethers.providers.Web3Provider(window.ethereum);
      const signer = provider.getSigner();
      const factory = new ethers.ContractFactory(
        HelloWorldArtifact.abi,
        HelloWorldArtifact.bytecode,
        signer
      );
      const contract = await factory.deploy(greet);
      await contract.deployed();
      onDeployed(contract.address);
    } catch (err) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  }

  return (
    <div>
      <h4>Deploy HelloWorld Contract</h4>
      <input
        placeholder="Greeting message"
        value={greet}
        onChange={(e) => setGreet(e.target.value)}
      />
      <button onClick={deploy} disabled={loading || !greet}>
        {loading ? "Deploying‚Ä¶" : "Deploy"}
      </button>
      {error && <p style={{ color: "red" }}>{error}</p>}
    </div>
  );
}
```
